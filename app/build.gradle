/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java application project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/8.0.2/userguide/building_java_projects.html
 */

plugins {
  // Apply the application plugin to add support for building a CLI application in Java.
  id 'application'
  id 'java'
}

repositories {
  // Use Maven Central for resolving dependencies.
  mavenCentral()
}


def urlFile = { url, name ->
  File file = new File("$buildDir/download/${name}.jar")
  file.parentFile.mkdirs()
  if (!file.exists()) {
    new URL(url).withInputStream { downloadStream ->
      file.withOutputStream { fileOut ->
        fileOut << downloadStream
      }
    }
  }
  files(file.absolutePath)
}

dependencies {
  implementation "com.google.code.gson:gson:2.10"
  implementation urlFile('https://github.com/crawligans/webserver/releases/latest/download/webserver.jar', 'webserver')
  implementation urlFile('https://github.com/crawligans/kvs/releases/latest/download/KVSMaster.jar', 'kvs')
  implementation urlFile('https://github.com/crawligans/flame/releases/latest/download/FlameFlameSubmit.jar', 'flame')
}

application {
  // Define the main class for the application.
  mainClass = 'cis5550.search.Main'
  archivesBaseName 'search'
}

compileJava {
  options.debug = project.hasProperty('debug')
}

applicationDistribution.from('site') {
  into ''
}

distributions {
  main {
    distributionBaseName = 'search'
  }
}
